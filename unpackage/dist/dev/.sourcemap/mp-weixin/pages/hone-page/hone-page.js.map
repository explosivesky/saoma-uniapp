{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/Administrator/Desktop/saoma-uniapp/pages/hone-page/hone-page.vue?5082","webpack:///C:/Users/Administrator/Desktop/saoma-uniapp/pages/hone-page/hone-page.vue?9206","webpack:///C:/Users/Administrator/Desktop/saoma-uniapp/pages/hone-page/hone-page.vue?5ce9","webpack:///C:/Users/Administrator/Desktop/saoma-uniapp/pages/hone-page/hone-page.vue?af7f","uni-app:///pages/hone-page/hone-page.vue","webpack:///C:/Users/Administrator/Desktop/saoma-uniapp/pages/hone-page/hone-page.vue?ecac","webpack:///C:/Users/Administrator/Desktop/saoma-uniapp/pages/hone-page/hone-page.vue?80f4"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,wG;AACAA,UAAU,CAACC,iBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkI;AAClI;AAC6D;AACL;AACqC;;;AAG7F;AACiL;AACjL,gBAAgB,mLAAU;AAC1B,EAAE,+EAAM;AACR,EAAE,gGAAM;AACR,EAAE,yGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA+pB,CAAgB,ipBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC0FnrB,oF;;;AAGA;AACA,0DADA;AAEA,MAFA,kBAEA;AACA;AACA,qBADA,EACA;AACA,iBAFA,EAEA;AACA,sBAHA,EAGA;AACA,eAJA,EAIA;AACA,cALA,EAKA;AACA,qBANA,EAMA;AACA,oBAPA,EAOA;AACA,uBARA,EAQA;AACA,eATA,EASA;AACA,4DAVA,EAUA;AACA,yCAXA;AAYA,kDAZA;AAaA,kBAbA;;AAeA,GAlBA;AAmBA;AACA,WADA,qBACA;AACA;AACA,mBAFA,GAEA,wBAFA;AAGA,oFAHA,SAGA,GAHA;AAIA;AACA,6DALA;AAMA,KAPA,EAOA;AACA,UARA,kBAQA,KARA,EAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OALA,MAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAxBA;AAyBA;AACA,QA1BA,gBA0BA,CA1BA,EA0BA,WA1BA,EA0BA,GA1BA,EA0BA,MA1BA,EA0BA;AACA,cADA,GACA,MADA,CACA,QADA,CACA,KADA,GACA,MADA,CACA,KADA,CACA,IADA,GACA,MADA,CACA,IADA,CACA,SADA,GACA,MADA,CACA,SADA,CACA,IADA,GACA,MADA,CACA,IADA,CACA,EADA,GACA,MADA,CACA,EADA;AAEA;AACA;AACA;AACA;AACA;AACA,KAjCA;AAkCA;AACA,QAnCA,gBAmCA,CAnCA,EAmCA,WAnCA,EAmCA,GAnCA,EAmCA,MAnCA,EAmCA;AACA,cADA,GACA,MADA,CACA,QADA,CACA,KADA,GACA,MADA,CACA,KADA,CACA,IADA,GACA,MADA,CACA,IADA,CACA,SADA,GACA,MADA,CACA,SADA,CACA,IADA,GACA,MADA,CACA,IADA,CACA,EADA,GACA,MADA,CACA,EADA;AAEA;AACA;AACA;AACA;AACA,KAzCA;AA0CA;AACA,iBA3CA,yBA2CA,GA3CA,EA2CA;AACA;;;AAGA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAJA,MAIA;AACA;AACA;AACA;AACA;AACA;AACA,KA9DA;AA+DA;AACA,iBAhEA,2BAgEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAJA;AAKA,SANA,MAMA;AACA;AACA;AACA;AACA,OAXA;AAYA;AACA;AACA;AACA,OAHA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAxGA;AAyGA;AACA,UA1GA,kBA0GA,KA1GA,EA0GA,GA1GA,EA0GA;AACA;AACA;AACA;AACA;AACA,OAFA,EAEA,GAFA;AAGA,KAhHA;AAiHA;AACA,UAlHA,oBAkHA;AACA;AACA,KApHA;AAqHA;AACA,YAtHA,oBAsHA,KAtHA,EAsHA,EAtHA,EAsHA,IAtHA,EAsHA;AACA,eADA,GACA,IADA,CACA,SADA,CACA,CADA,GACA,IADA,CACA,CADA,CACA,WADA,GACA,IADA,CACA,WADA,CACA,GADA,GACA,IADA,CACA,GADA;AAEA;AACA;AACA;AACA;AACA;AACA,KA7HA;AA8HA;AACA,SA/HA,mBA+HA;AACA;AACA;AACA;AACA,OAFA;AAGA;AACA;AACA;AACA,SAFA;AAGA,OAJA;AAKA,KAzIA;AA0IA;AACA,UA3IA,oBA2IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAnJA;AAoJA;AACA,gBArJA,0BAqJA;AACA;AACA;AACA;AACA,OAFA;AAGA;AACA;AACA;AACA,wBADA;AAEA,uBAFA;AAGA,wBAHA;;AAKA;AACA;AACA;AACA;AACA,+BADA;AAEA;AACA;AACA,SAJA;AAKA;AACA;AACA,SAPA;;;AAUA,KA9KA;AA+KA;AACA,gBAhLA,wBAgLA,GAhLA,EAgLA;AACA;AACA;AACA,kCADA;AAEA,4BAFA;;AAIA,6BANA,GAMA,CANA;AAOA;AACA;AACA;AACA,iBAFA;AAGA;AACA,sBAZA,GAYA,2BAZA;AAaA,mBAbA,GAaA,wBAbA;AAcA,4BAdA,GAcA,8BAdA;AAeA,gCAfA,GAeA,2BAfA;AAgBA,qBAhBA,GAgBA;AACA,4CADA;AAEA,0BAFA;AAGA,gCAHA;AAIA,oDAJA;AAKA,uFALA;AAMA,8CANA;AAOA,6DAPA;AAQA,gDARA;AASA,+CATA;AAUA,6DAVA,EAhBA;;AA4BA;AA5BA,2CA6BA,+DA7BA,SA6BA,MA7BA;AA8BA;AACA,sBA/BA,GA+BA,qBA/BA;AAgCA;AACA,uCADA,EACA;AACA,mDAFA,EAEA;AACA;AACA;AACA,mBALA;AAMA;AACA;AACA,mBARA;;AAUA;AACA;AACA,2DADA,IA3CA;;AA8CA,KA9NA;AA+NA;AACA,eAhOA,yBAgOA;AACA;AACA;AACA,mCADA;;AAGA,KArOA,EAnBA;;AA0PA,QA1PA,oBA0PA;AACA;AACA,GA5PA;AA6PA,SA7PA,qBA6PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAHA;AAIA,OALA;AAMA;AACA,KAbA,EAaA,GAbA;AAcA,GA7QA;AA8QA;AACA;AACA,cAFA,wBAEA;AACA;AACA;AACA;AACA,OAFA;AAGA;AACA,KARA,EA9QA,E;;;;;;;;;;;;;AC7FA;AAAA;AAAA;AAAA;AAAi+B,CAAgB,06BAAG,EAAC,C;;;;;;;;;;;ACAr/B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/hone-page/hone-page.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/hone-page/hone-page.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./hone-page.vue?vue&type=template&id=1a378dc4&scoped=true&\"\nvar renderjs\nimport script from \"./hone-page.vue?vue&type=script&lang=js&\"\nexport * from \"./hone-page.vue?vue&type=script&lang=js&\"\nimport style0 from \"./hone-page.vue?vue&type=style&index=0&id=1a378dc4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1a378dc4\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/hone-page/hone-page.vue\"\nexport default component.exports","export * from \"-!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./hone-page.vue?vue&type=template&id=1a378dc4&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./hone-page.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./hone-page.vue?vue&type=script&lang=js&\"","<template>\r\n  <view>\r\n    <!-- 顶部 -->\r\n    <view class=\"top-view\">\r\n      <view>{{diners}}人就餐</view>\r\n      <view class=\"top-view-flex\">\r\n        <image src=\"/static/tab/fenxiang.svg\" mode=\"widthFix\" class=\"top-search\"></image>\r\n        <image src=\"/static/tab/dingdan.svg\" mode=\"widthFix\" @click=\"goToMyOrder\"></image>\r\n      </view>\r\n    </view>\r\n    <!-- 点餐界面 -->\r\n    <view class=\"order-view\">\r\n      <view class=\"commodity\">\r\n        <!-- 左 -->\r\n        <view class=\"order-left\">\r\n          <scroll-view scroll-y=\"true\" class=\"scroll-Hei\" :scroll-with-animation=\"true\" :enhanced=\"true\" :show-scrollbar=\"false\" >\r\n\t\t\t<block v-for=\"(item,i) in cate\" :key='i'>\r\n\t\t\t\t<view class=\"itemize-text\"  @click=\"handle(i,item.cid)\" :class=\"{active:i==currentIndex}\">\r\n\t\t\t\t  <text>{{item.category}}</text>\r\n\t\t\t\t  <block v-if=\"item.sele_quantity > 0\"> <text>{{item.sele_quantity}}</text></block>\r\n\t\t\t\t</view>\r\n\t\t\t</block>\r\n          </scroll-view>\r\n        </view>\r\n        <!-- 右 -->\r\n        <view class=\"order-right\">\r\n          <scroll-view scroll-y=\"true\" class=\"scroll-Hei\" :scroll-with-animation=\"true\" :enhanced=\"true\" :show-scrollbar=\"false\"  @scroll=\"scroLl\" :scroll-into-view=\"scroll_into\"> \r\n           <block v-for=\"(item,i) in goods\" :key='i'>\r\n\t\t\t   <view class=\"rig-height\" :id=\"item.cid\">\r\n\t\t\t     <view class=\"classif\">{{item.category}}</view>\r\n\t\t\t     <view class=\"classif-goods\" @click=\"detail(true,detail,goods_index,item.cid,i)\" v-for=\"(detail,goods_index) in item.query\" :key='goods_index'>\r\n\t\t\t       <view class=\"goods-image\">\r\n\t\t\t         <image :src=\"detail.image[0].url\" mode=\"aspectFill\"></image>\r\n\t\t\t       </view>\r\n\t\t\t       <view class=\"goods-Price\">\r\n\t\t\t         <view class=\"goods-name\">\r\n\t\t\t           <text class=\"Bold\">{{detail.name}}</text>\r\n\t\t\t           <text class=\"Thinning\">已售 {{detail.shopsell}}</text>\r\n\t\t\t         </view>\r\n\t\t\t         <view class=\"unit-price\">\r\n\t\t\t           <text class=\"Symbol\">¥</text>\r\n\t\t\t           <text class=\"Bold\">{{detail.signprice}}</text>\r\n\t\t\t           <text class=\"Thinning\">/{{detail.unit}}</text>\r\n\t\t\t         </view>\r\n\t\t\t       </view>\r\n\t\t\t       <view class=\"quantity\">\r\n\t\t\t         <view>\r\n\t\t\t           <image src=\"/static/tab/jianhao.png\" mode=\"widthFix\" v-if=\"detail.quantity > 0\" @click.stop=\"decr(i,goods_index,item.cid,detail)\"></image>\r\n\t\t\t         </view>\r\n\t\t\t         <view><text v-if=\"detail.quantity > 0\">{{detail.quantity}}</text></view>\r\n\t\t\t         <view>\r\n\t\t\t           <image src=\"/static/tab/jia.png\" mode=\"widthFix\" @click.stop=\"plus(i,goods_index,item.cid,detail)\"></image>\r\n\t\t\t         </view>\r\n\t\t\t       </view>\r\n\t\t\t     </view>\r\n\t\t\t   </view>\r\n\t\t   </block>\r\n            <view style=\"height: 400rpx;\"></view>\r\n          </scroll-view>\r\n        </view>\r\n      </view>\r\n      <!-- 底部 -->\r\n      <view class=\"order-bottom\" :style=\"{'padding-bottom':iphongCheck==true ? '50rpx':''}\" @click=\"bottom\">\r\n        <view class=\"Shopping\" style=\"width: 115rpx;\">\r\n          <view class=\"Shopping-left\">\r\n            <image src=\"/static/tab/gouwuche.png\" mode=\"widthFix\"></image>\r\n          </view>\r\n          <view class=\"Shopping-number\" v-if=\"countTotal > 0\">{{countTotal}}</view>\r\n        </view>\r\n        <view class=\"Shopping-title\">已点{{countTotal}}份菜品</view>\r\n        <view class=\"place-order\">\r\n          <button plain=\"true\" open-type=\"getUserInfo\" @click.stop=\"subscription\">选好了</button>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    <!-- 单个商品详情 -->\r\n    <Details v-if=\"popupitem\" :popup=\"popup\"></Details>\r\n    <!-- 购物车 -->\r\n    <Cart v-if=\"card\" :shopping_card=\"shopping_card\"></Cart>\r\n\t<!-- 骨架屏 -->\r\n\t<home v-if=\"isShow\"></home>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\n// 单个商品详情\r\nimport Details from './components/goods-details.vue'\r\n// 购物车\r\nimport Cart from './components/shopping-cart.vue'\r\n//生成订单编号\r\nimport {orderCode} from '../../utils/placeOrderCode.js'\r\n//骨架屏\r\nimport home from '../skeleton/home.vue'\r\nexport default {\r\n  components: { Cart ,Details,home},\r\n  data () {\r\n    return {\r\n      scroll_into: '',//点击指示到谁\r\n      card: false,//购物车隐藏与否\r\n      popupitem: false,//单个商品隐藏与否\r\n\t  goods:[],//响应商品数据\r\n\t  cate:[],//响应分类数据\r\n\t  currentIndex:0,//当前索引\r\n\t  heightList:[],//记录每个 右侧 盒子的高度\r\n\t  shopping_card:[],//购物车的数据\r\n\t  popup:{},//商品弹窗数据\r\n\t  tmplIds:'Z-i5aHP8zP3HNO4MyeoNK9OY9_LfvT6t36Veg3oTbK8',//订阅消息模板ID\r\n\t  diners:wx.getStorageSync('diners'),\r\n\t  iphongCheck:getApp().globalData.iphongCheck,\r\n\t  isShow:true\r\n    }\r\n  },\r\n  methods: {\r\n async getData(){\r\n\t //获取菜品数据\r\n\t let uid = wx.getStorageSync('uid');\r\n\t let res = await new this.$Requst('/uniapp/getDishes', 'POST', { uid }).req();\r\n\t this.goods=res.data.data.response.res_data\r\n\t this.cate=res.data.data.response.res_cate\r\n  },//左右联动\r\n  scroLl(event){\r\n\t  let scrollTop=event.detail.scrollTop\r\n\t  if(scrollTop >= this.scrollTop){\r\n\t\t  //下拉\r\n\t\t  if(scrollTop >= this.heightList[this.currentIndex]){\r\n\t\t\t  this.currentIndex +=1\r\n\t\t  }\r\n\t  }else{\r\n\t\t  //上拉\r\n\t\t  //1  - 103\r\n\t\t  if(scrollTop < this.heightList[this.currentIndex-1]){\r\n\t\t\t  this.currentIndex -=1\r\n\t\t  }\r\n\t  }\r\n\t  //全局记录一下\r\n\t  this.scrollTop=scrollTop\r\n  },\r\n  //商品 加一\r\n\t plus(i,goods_index,cid,detail){\r\n\t\t let{quantity,image,name,signprice,unit,id}=detail\r\n\t\tlet Qu = quantity+1\r\n\t\tthis.$set(this.goods[i].query[goods_index],'quantity',Qu)\r\n\t\t//给购物车准备数据\r\n\t\tlet obj={i,image,name,signprice,unit,id,cid,goods_index,quantity:Qu,total_price:Qu*signprice}\r\n\t\tthis.shopping_cart(obj)\r\n\t } ,\r\n\t //商品减一\r\n\t decr(i,goods_index,cid,detail){\r\n\t\tlet{quantity,image,name,signprice,unit,id}=detail\r\n\t\t let Qu=quantity - 1\r\n\t\t this.$set(this.goods[i].query[goods_index],'quantity',Qu)\r\n\t\t let obj={i,image,name,signprice,unit,id,cid,goods_index,quantity:Qu,total_price:Qu*signprice}\r\n\t\t this.shopping_cart(obj)\r\n\t },\r\n\t //添加购物车\r\n\t shopping_cart(obj){\r\n\t\t /**\r\n\t\t  * 如果数组为空 ? 直接添加 : 判断 id 是否相同，相同就 更新视图层\r\n\t\t  * */ \r\n\t\t if(!this.shopping_card.length){\r\n\t\t\t this.shopping_card.unshift(obj)\r\n\t\t }else{\r\n\t\t  let res = this.shopping_card.findIndex(i=>i.id==obj.id)\r\n\t\t  //菜品存在\r\n\t\t  if(res != -1){\r\n\t\t\t  //更新视图层\r\n\t\t\t  this.$set(this.shopping_card[res],'quantity',obj.quantity)\r\n\t\t\t  this.$set(this.shopping_card[res],'total_price',obj.total_price)\r\n\t\t  }else{\r\n\t\t\t  //不存在\r\n\t\t\t  this.shopping_card.unshift(obj)\r\n\t\t  }\r\n\t\t }\r\n\t\t this.left_quantity()\r\n\t },\r\n\t //计算左边各类下添加了多少类\r\n\t left_quantity(){\r\n\t\t //数组去重的方式写的\r\n\t\t let obj={}\r\n\t\t let arr=[]\r\n\t\tthis.shopping_card.forEach((i,ind)=>{\r\n\t\t\tif(obj[i.cid]){\r\n\t\t\t\tarr.forEach(item=>{\r\n\t\t\t\t\tif(item.cid==i.cid){\r\n\t\t\t\t\t\titem.value += i.quantity\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n\t\t\t\tobj[i.cid]=true\r\n\t\t\t\tarr.push({'cid':i.cid,'value':i.quantity})\r\n\t\t\t}\r\n\t\t})\r\n\t\t arr.forEach(item=>{\r\n\t\t\t\t let index = this.cate.findIndex(itemSub=>item.cid == itemSub.cid)\r\n\t\t\t\t this.$set(this.cate[index],'sele_quantity',item.value)\r\n\t\t })\r\n\t\t //原方法\r\n\t\t//  let obj={}\r\n\t\t//  //shopping_card vue全局保存了\r\n\t\t// shopping_card.forEach(i=>{\r\n\t\t// \tif(!obj[i.cid]){\r\n\t\t// \t\tobj[i.cid]=i.quantity //{'c12313':quantity}\r\n\t\t// \t}else{\r\n\t\t// \t\tobj[i.cid]+=i.quantity\r\n\t\t// \t}\r\n\t\t// })\r\n\t\t// // console.log(obj)//{c1636614024836: 2, c1636614118528: 1}\r\n\t\t//  let m=[]\r\n\t\t//  for(let i in obj){\r\n\t\t// \t m.push({'cid':i,'value':obj[i]})\r\n\t\t//  }\r\n\t\t//  // console.log(m)//[0:{cid: \"c1636614024836\", value: 2},1: {cid: \"c1636614118528\", value: 1}]\r\n\t\t//  m.forEach(item=>{\r\n\t\t// \t let index = this.cate.findIndex(itemSub=>item.cid == itemSub.cid)\r\n\t\t// \t this.$set(this.cate[index],'sele_quantity',item.value)\r\n\t\t//  })\r\n\t },\r\n\t //绑定 currentindex\r\n  handle(index,cid){\r\n\t  this.currentIndex=index\r\n\t  this.scroll_into= cid\r\n\t  setTimeout(()=>{\r\n\t\t  this.scroll_into=''\r\n\t  },150)\r\n  },\r\n  //控制 购物车显示\r\n  bottom(value = true){\r\n\t  this.card=value\r\n  },\r\n  //给购物车组件调用的方法\r\n  cartCtrl(index,Qu,item){\r\n\t  let{signprice,i,goods_index,cid}=item\r\n\t  this.$set(this.shopping_card[index],'quantity',Qu)\r\n\t  this.$set(this.shopping_card[index],'total_price',Qu * signprice)\r\n\t  this.$set(this.goods[i].query[goods_index],'quantity',Qu)\r\n\t  //更新左边商品数量视图层\r\n\t  this.left_quantity()\r\n  },\r\n  //清空列表\r\n  empty(){\r\n\t  this.shopping_card=[]\r\n\t  this.cate.forEach(i=>{\r\n\t\t  i.sele_quantity = 0\r\n\t  })\r\n\t  this.goods.forEach(i=>{\r\n\t\t  i.query.forEach(iSub=>{\r\n\t\t\t  iSub.quantity=0\r\n\t\t  })\r\n\t  })\r\n  },\r\n  //商品详情弹窗\r\n  detail(value=true,detail,goods_index,cid,i){\r\n\t  this.popupitem = value\r\n\t  //如果是 弹窗调用就没必要过去当前商品 数据了\r\n\t  if(value == false)return\r\n\t  detail.goods_index=goods_index\r\n\t  detail.i=i\r\n\t  detail.cid=cid\r\n\t  this.popup = detail\r\n  },\r\n  //订阅消息\r\nsubscription(){\r\n\t//过滤到 价格 为 0 的菜品(因为之前数量 = 0 的数据没删除)\r\n\tlet res = this.shopping_card.filter(i=>{\r\n\t\t\t  return i.total_price != 0\r\n\t})\r\n\t//防止用户没选菜品 直接点餐\r\n\tif(res.length==0){\r\n\t\twx.showToast({\r\n\t\t  title: '请选择菜品',\r\n\t\t  icon: 'error',\r\n\t\t  duration: 2000\r\n\t\t})\r\n\t\treturn\r\n\t}\r\n\t//订阅消息\r\n\twx.requestSubscribeMessage({\r\n\t  tmplIds: [this.tmplIds],\r\n\t  success: (result) =>{\r\n\t\t  this.placeAnOrder(res)\r\n\t  },\r\n\t  fail:(err)=>{\r\n\t\t  console.log(err)\r\n\t  }\r\n\t})\r\n\r\n},\r\n  //提交订单到数据库\r\n  async placeAnOrder(res){\r\n\t  //loading组件\r\n\t  wx.showLoading({\r\n\t    title: '提交中，请稍后',\r\n\t\tmask:true\r\n\t  })\r\n\t  let settle_amount = 0\r\n\t  //金额总数相加\r\n\t  res.forEach(i=>{\r\n\t\t  settle_amount += i.total_price\r\n\t  })\r\n\t  //获取 openid\r\n\t  let openId = wx.getStorageSync('openid')\r\n\t  let uid = wx.getStorageSync('uid');\r\n\t  let table_number=wx.getStorageSync('table_num');\r\n\t  let number_of_diners=wx.getStorageSync('diners')\r\n\t  let order={\r\n\t\t  table_number,\r\n\t\t  uid,\r\n\t\t  openId,\r\n\t\t  number_of_diners,\r\n\t\t  order_time:this.$moment().utcOffset(8).format('YY-MM-DD HH:mm:ss'),\r\n\t\t  settle_amount,\r\n\t\t  order_num:orderCode(),\r\n\t\t  transaction_status:'unsettle',\r\n\t\t  order_receiving:'miss_order',\r\n\t\t  menu:[{backup:'备用字段',goods_list:res}]\r\n\t  }\r\n\t  //发送订单\r\n\t  let resule = await new this.$Requst('/uniapp/submitDishes', 'POST', order).req();\r\n\t//发送消息给 后台管理页面\r\n\tvar pubsub = this.$goeasy.pubsub;\r\n\tpubsub.publish({\r\n\t    channel: \"my_channel\",//替换为您自己的channel\r\n\t    message: wx.getStorageSync('uid'),//替换为您想要发送的消息内容\r\n\t    onSuccess:function(){\r\n\t        console.log(\"消息发布成功。\");\r\n\t    },\r\n\t    onFailed: function (error) {\r\n\t        console.log(\"消息发送失败，错误编码：\"+error.code+\" 错误信息：\"+error.content);\r\n\t    }\r\n\t});\r\n\t//跳转到订单页面\r\n\twx.redirectTo({\r\n\t  url: '../order-detail/order-detail?val=1'\r\n\t})\r\n  },\r\n  //跳转到我的订单页面\r\n  goToMyOrder(){\r\n\t  //两个页面没关联，所以保留当前页面，跳转到应用内的某个页面\r\n\t  wx.navigateTo({\r\n\t\t  url:'../my-order/my-order'\r\n\t  })\r\n  }\r\n},\r\n  onLoad () {\r\n\tthis.getData()\r\n  },\r\n  mounted(){\r\n\t  //获取 每个 分类的元素高度\r\n\t\tsetTimeout(()=>{\r\n\t\t\tlet height=0\r\n\t\t\tconst query = uni.createSelectorQuery()\r\n\t\t\t\t    // select 默认只选中一个元素  而 rig-height v-for 遍历了好几个\r\n\t\t\t\t    //而 selectAll 选中所有元素 \r\n\t\t\t\t    query.selectAll('.rig-height').boundingClientRect()\r\n\t\t\t\t    query.exec((res)=>{\r\n\t\t\t\t\t\tres[0].forEach(i=>{\r\n\t\t\t\t\t\t\theight += i.height\r\n\t\t\t\t\t\t\tthis.heightList.push(height)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t    })\r\n\t\t\t\t\tthis.isShow=false\r\n\t\t},100)\r\n  },\r\n  computed:{\r\n\t  //计算点餐总数\r\n\t  countTotal(){\r\n\t\t  let count=0\r\n\t\t  this.shopping_card.forEach(i=>{\r\n\t\t\t\t  count += i.quantity\r\n\t\t  })\r\n\t\t  return count\r\n\t  }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.top-view {\r\n  background: linear-gradient(\r\n    to bottom,\r\n    #f7d45f,\r\n    #f7d562,\r\n    #f8d561,\r\n    #f9db76,\r\n    #f9de80\r\n  );\r\n  height: 120rpx;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 0 20rpx;\r\n  position: fixed;\r\n  top: 0;\r\n  right: 0;\r\n  left: 0;\r\n}\r\n.top-view image {\r\n  display: block;\r\n  width: 35rpx;\r\n  height: 35rpx;\r\n}\r\n.top-view-flex {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.top-search {\r\n  padding-right: 50rpx;\r\n}\r\n/* 点餐界面 */\r\n.order-view {\r\n  margin-top: 120rpx;\r\n}\r\n.commodity {\r\n  display: flex;\r\n  position: fixed;\r\n  top: 120rpx;\r\n  left: 0;\r\n  right: 0;\r\n}\r\n.order-left {\r\n  background-color: #fafafa;\r\n  width: 150rpx;\r\n  overflow-y: auto;\r\n}\r\n.itemize-text {\r\n  font-size: 27rpx;\r\n  padding: 30rpx 10rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  color: #797979;\r\n}\r\n.itemize-text text:nth-child(1) {\r\n  flex: 1;\r\n}\r\n.itemize-text text:nth-child(2) {\r\n  background-color: #eb5941;\r\n  border-radius: 50%;\r\n  font-size: 20rpx;\r\n  color: #ffffff;\r\n  width: 30rpx;\r\n  height: 30rpx;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin-left: 2rpx;\r\n}\r\n.scroll-Hei {\r\n  height: 100vh;\r\n  /* white-space: nowrap; */\r\n}\r\n.order-right {\r\n  background-color: #ffffff;\r\n  flex: 1;\r\n  overflow-y: auto;\r\n}\r\n.classif {\r\n  font-size: 27rpx;\r\n  padding: 30rpx 20rpx;\r\n  color: #797979;\r\n}\r\n/* 分类商品 */\r\n.classif-goods {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 0 20rpx;\r\n  height: 150rpx;\r\n  font-size: 30rpx;\r\n  margin-bottom: 45rpx;\r\n}\r\n\r\n.goods-image image {\r\n  display: block;\r\n  width: 150rpx;\r\n  height: 150rpx;\r\n  border-radius: 10rpx;\r\n}\r\n.goods-Price {\r\n  flex: 1;\r\n  position: relative;\r\n  padding: 0 20rpx;\r\n}\r\n.goods-Price text {\r\n  display: block;\r\n}\r\n.goods-name {\r\n  display: flex;\r\n  flex-direction: column;\r\n  position: relative;\r\n  top: 0;\r\n}\r\n.goods-name text:nth-child(1) {\r\n  padding-bottom: 9rpx;\r\n}\r\n.unit-price {\r\n  position: absolute;\r\n  bottom: 0;\r\n  display: flex;\r\n  align-items: baseline;\r\n}\r\n.Bold {\r\n  font-weight: bold;\r\n}\r\n.Symbol {\r\n  font-size: 20rpx;\r\n}\r\n.Thinning {\r\n  font-size: 25rpx;\r\n  color: #cccccc;\r\n}\r\n.quantity image {\r\n  width: 50rpx;\r\n  height: 50rpx;\r\n}\r\n.quantity view {\r\n  width: 50rpx;\r\n  height: 50rpx;\r\n  text-align: center;\r\n  line-height: 50rpx;\r\n}\r\n.quantity {\r\n  display: flex;\r\n  align-items: center;\r\n  align-self: flex-end;\r\n  width: 200rpx;\r\n  justify-content: space-between;\r\n}\r\n.order-bottom {\r\n  background-color: #fefefe;\r\n  height: 120rpx;\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  box-shadow: 0rpx -1.9rpx 1rpx 1rpx #f9f9f9;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 0 20rpx;\r\n  z-index: 9;\r\n}\r\n.Shopping image {\r\n  width: 75rpx;\r\n  height: 75rpx;\r\n  display: block;\r\n}\r\n.Shopping-left {\r\n  width: 75rpx;\r\n  height: 75rpx;\r\n}\r\n.Shopping {\r\n  display: flex;\r\n  align-items: center;\r\n  /* height: 120rpx; */\r\n}\r\n.Shopping-number {\r\n  align-self: flex-start;\r\n  background: #eb5941;\r\n  color: #ffff;\r\n  width: 40rpx;\r\n  border-radius: 50rpx;\r\n  text-align: center;\r\n  font-size: 20rpx;\r\n  /* margin-top: 15rpx; */\r\n}\r\n.Shopping-title {\r\n  flex: 1;\r\n  padding: 0 25rpx;\r\n  color: #999999;\r\n  /* height: 120rpx;\r\n\tline-height: 120rpx; */\r\n}\r\n.place-order button {\r\n  border: none;\r\n  background: linear-gradient(to right, #f8da81, #f8d771, #f7d362, #f6cb4a);\r\n  width: 200rpx;\r\n  height: 75rpx;\r\n  line-height: 75rpx;\r\n  border-radius: 50rpx;\r\n  font-weight: bold;\r\n  z-index: 9;\r\n}\r\n/* 点击分类列表加上背景色 */\r\n.active {\r\n  background-color: #ffffff;\r\n  color: #000000 !important;\r\n}\r\n</style>\r\n","import mod from \"-!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./hone-page.vue?vue&type=style&index=0&id=1a378dc4&scoped=true&lang=css&\"; export default mod; export * from \"-!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\360安全浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./hone-page.vue?vue&type=style&index=0&id=1a378dc4&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1638583658208\n      var cssReload = require(\"D:/360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}